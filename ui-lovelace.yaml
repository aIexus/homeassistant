title: Home Assistant - сервер

views:
   - title: Главная
     icon: mdi:home-assistant

     cards:

       - type: vertical-stack
         cards:

           - type: entity
             entity: sensor.time_date
             name: Время/Дата
             icon: mdi:calendar-clock

           - type: weather-forecast
             entity: weather.home
             show_forecast: false

           - type: conditional
             conditions:
                - entity: binary_sensor.m_novomoskovsk_alerts
                  state: 'on'
                - entity: input_boolean.disable_alerts_notifications
                  state: 'off'
             card:
                type: grid
                columns: 3
                title: Тревога
                cards:
                   - type: button
                     tap_action:
                       action: more-info
                     entity: binary_sensor.m_novomoskovsk_ta_novomoskovska_teritorialna_gromada_air
                     show_state: false
                     show_name: false
                     hold_action:
                       action: none
    
                   - type: button
                     tap_action:
                       action: more-info
                     entity: binary_sensor.m_novomoskovsk_ta_novomoskovska_teritorialna_gromada_artillery
                     show_state: false
                     show_name: false
                     hold_action:
                       action: none
    
                   - type: button
                     tap_action:
                       action: more-info
                     entity: binary_sensor.m_novomoskovsk_ta_novomoskovska_teritorialna_gromada_urban_fights
                     show_state: false
                     show_name: false
                     hold_action:
                       action: none

                   - type: button
                     tap_action:
                       action: more-info
                     entity: binary_sensor.m_novomoskovsk_ta_novomoskovska_teritorialna_gromada_chemical
                     show_state: false
                     show_name: false
                     hold_action:
                       action: none

                   - type: button
                     tap_action:
                       action: more-info
                     entity: binary_sensor.m_novomoskovsk_ta_novomoskovska_teritorialna_gromada_nuclear
                     show_state: false
                     show_name: false
                     hold_action:
                       action: none

                   - type: button
                     tap_action:
                       action: more-info
                     entity: binary_sensor.m_novomoskovsk_ta_novomoskovska_teritorialna_gromada_unknown
                     show_state: false
                     show_name: false
                     hold_action:
                       action: none

           - type: conditional
             conditions:
              - entity: binary_sensor.anyone_home
                state: "on"
             card:
              type: entity-filter
              entities:
                - person.alexus
                - person.inna
                - person.vova
                - person.ivan
              state_filter:
                - home
              show_empty: false
              card:
                type: glance
                show_state: false
                title: Сейчас Дома

           - type: 'custom:mini-media-player'
             entity: media_player.sonos_living_room
             name: 'Living Room: Sonos One'
             artwork: cover
             state_label: true
             hide:
               power: true
            #  shortcuts:
            #     columns: 4 
            #     buttons:
            #       # Start predefined playlist
            #       - name: Rock Your Body
            #         type: script
            #         # id: spotify:user:31btn5tswjqya34vyszn6fcdbcxu:playlist:37i9dQZF1DXbFRZSqP41al
            #         id: script.sonos_play_spotify_playlist
            #         data:
            #           sonos_entity: media_player.sonos_living_room
            #           playlist_id: 37i9dQZF1DXbFRZSqP41al
            #       - name: Rock Me Up
            #         type: 'music'
            #         id: 'https://open.spotify.com/playlist/37i9dQZF1DX0wiundViT27'
            #       - name: TEST
            #         type: service
            #         id: media_player.play_media
            #         data:
            #           entity_id: media_player.sonos_living_room
            #           media_content_id: https://open.spotify.com/playlist/37i9dQZF1DX0wiundViT27
            #           media_content_type: music
            #  speaker_group:
            #   platform: sonos
            #   show_group_count: true
            #   entities:
            #      - entity_id: media_player.sonos_living_room
            #       name: Sonos Living Room
            #      - entity_id: media_player.sonos_living_room
            #       name: Sonos LR 2
            #      - entity_id: media_player.sonos_living_room
            #       name: Sonos LR 3
            #  entities:
            #   - type: 'custom:mini-media-player'
            #      entity: media_player.multiroom_player
            #      group: true
            #      source: icon
            #      artwork: cover
            #      info: short
            #      hide:
            #       volume: true
            #       power: true
            #   - type: 'custom:mini-media-player'
            #      entity: media_player.sonos_living_room
            #      group: true
            #      hide:
            #       controls: true
            #   - type: 'custom:mini-media-player'
            #      entity: media_player.sonos_living_room
            #      group: true
            #      hide:
            #       controls: true
            #   - type: 'custom:mini-media-player'
            #      entity: media_player.sonos_living_room
            #      group: true
            #      hide:
            #       controls: true

       - type: vertical-stack
         cards: 

            - type: grid
              columns: 3
              title: Управление
              cards:
                - type:  conditional
                  conditions: 
                    - entity: input_boolean.heating_status
                      state: 'on'
                  card:
                    type: button
                    tap_action:
                      action: toggle
                    entity: input_boolean.enable_manual_control_heater
                    show_state: false
                    show_name: false
                    hold_action:
                      action: none

                - type:  conditional
                  conditions: 
                    - entity: input_boolean.ac_status
                      state: 'on'
                  card:
                    type: button
                    tap_action:
                      action: toggle
                    entity: input_boolean.enable_manual_control_ac
                    show_state: false
                    show_name: false
                    hold_action:
                      action: none

                - type: button
                  tap_action:
                    action: toggle
                  entity: input_boolean.enable_manual_control_lights
                  show_state: false
                  show_name: false
                  hold_action:
                    action: none

                - type: button
                  tap_action:
                    action: toggle
                  entity: input_boolean.enable_manual_control_aqua_lights
                  show_state: false
                  show_name: false
                  hold_action:
                    action: none

                # - type: button
                #   tap_action:
                #     action: none
                #   entity: binary_sensor.bathroom_washing_machine_socket_status
                #   show_state: false
                #   show_name: false
                #   hold_action:
                #     action: none

                # - type: button
                #   tap_action:
                #     action: toggle
                #   entity: input_boolean.enable_manual_control_garlands
                #   show_state: false
                #   show_name: false
                #   hold_action:
                #     action: none

            - type: conditional
              conditions:
                - entity: input_boolean.enable_manual_control_heater
                  state: 'on'
                - entity: input_boolean.heating_status
                  state: 'on'
              card:
                type: grid
                title: Обогреватели
                cards:
                  - type: thermostat
                    entity: climate.living_room_heater
                    name: Гостинная
                  - type: thermostat
                    entity: climate.bedroom_heater
                    name: Спальня
                  - type: thermostat
                    entity: climate.kitchen_heater
                    name: Кухня

            - type: conditional
              conditions:
                - entity: input_boolean.enable_manual_control_ac
                  state: 'on'
                - entity: input_boolean.ac_status
                  state: 'on'
              card:
                type: grid
                columns: 2
                title: Кондиционеры
                cards:
                  - type: thermostat
                    entity: climate.living_room_ac
                    name: Гостинная
                  - type: thermostat
                    entity: climate.bedroom_ac
                    name: Спальня

            - type: conditional
              conditions:
                - entity: input_boolean.enable_manual_control_lights
                  state: 'on'
              card:
                type: entities
                show_header_toggle: true
                title: Освещение
                icon: mdi:ceiling-light-multiple-outline
                state_color: true
                entities:
                  - entity: switch.living_room_light_switch
                    name: Гостинная
                  - entity: switch.bedroom_light_switch
                    name: Спальня
                  - entity: light.hallway_rgb_bulb
                    name: Коридор

            - type: conditional
              conditions:
                - entity: input_boolean.enable_manual_control_aqua_lights
                  state: 'on'
              card:
                type: entities
                show_header_toggle: true
                title: Аквариум
                icon: mdi:ceiling-light-multiple-outline
                state_color: true
                entities:
                  - entity: switch.living_room_aquarium_main_lighting
                    name: Основной свет
                  - entity: switch.living_room_aquarium_moonlight
                    name: Лунный свет

            # - type: conditional
            #   conditions:
            #     - entity: input_boolean.enable_manual_control_garlands
            #       state: 'on'
            #   card:
            #     type: entities
            #     show_header_toggle: true
            #     title: Гирлянды
            #     icon: mdi:ceiling-light-multiple-outline
            #     state_color: true
            #     entities:
            #       - entity: switch.living_room_christmas_tree
            #         name: Ёлочная
            #       - entity: switch.living_room_garland_curtain
            #         name: Штора
            #       - entity: switch.living_room_top_garland
            #         name: Верхняя

   - title: Система
     icon: mdi:monitor-dashboard
     cards:

       - type: vertical-stack
         cards:

           - type: entity
             entity: sensor.time_date
             name: Время/Дата
             icon: mdi:calendar-clock

           - type: entities
             show_header_toggle: false
             title: Статус Системы
             entities:
               - entity: sensor.last_boot_custom
                 name: Last boot
               - entity: sensor.online_custom
               - entity: update.home_assistant_core_update
                 icon: mdi:home-assistant
               - entity: update.home_assistant_supervisor_update
                 icon: mdi:home-assistant
               - entity: sensor.hacs
                 name: HACS

           - type: entities
             show_header_toggle: false
             state_color: true
             title: Статус питания
             entities:
               - entity: binary_sensor.rpi_ac_power_status
               - entity: binary_sensor.ups_battery_low
               - entity: sensor.ups_battery_capacity
               - entity: sensor.ups_battery_voltage

           - type: entities
             show_header_toggle: false
             title: Резервное копирование
             entities:
               - entity: sensor.last_google_backup_train
               - entity: sensor.snapshots_in_google_drive_train
               - entity: sensor.snapshots_in_hassio_train

       - type: vertical-stack
         cards:

           - type: grid
             columns: 2
             title: Системные показатели
             cards:

               - type: gauge
                 name: Загрузка CPU
                 unit: '%'
                 entity: sensor.processor_use
                 severity:
                   green: 0
                   yellow: 60
                   red: 85

               - type: gauge
                 name: Температура CPU
                 unit: '°C'
                 entity: sensor.processor_temperature
                 severity:
                  green: 0
                  yellow: 60
                  red: 85

               - type: gauge
                 name: Загрузка ОЗУ
                 unit: '%'
                 entity: sensor.memory_use_percent
                 severity:
                   green: 0
                   yellow: 60
                   red: 85

               - type: gauge
                 name: Использовано ОЗУ
                 unit: 'МБ'
                 min: 0
                 max: 8192
                 entity: sensor.memory_use
                 severity:
                   green: 0
                   yellow: 6144
                   red: 7168

               - type: gauge
                 name: Использовано SWAP
                 unit: '%'
                 entity: sensor.swap_use_percent
                 severity:
                   green: 0
                   yellow: 60
                   red: 85

               - type: gauge
                 name: Свободно SWAP
                 unit: 'МБ'
                 min: 0
                 max: 1024
                 entity: sensor.swap_free
                 severity:
                   green: 600
                   yellow: 350
                   red: 100

               - type: gauge
                 name: Диск Заполнен
                 unit: '%'
                 entity: sensor.disk_use_percent
                 severity:
                   green: 0
                   yellow: 60
                   red: 85

               - type: gauge
                 name: Свободное Место
                 unit: 'Гб'
                 entity: sensor.disk_free
                 severity:
                   red: 50
                   yellow: 150
                   green: 250         

       - type: vertical-stack
         title: Статистика БД
         cards:

           - type: entities
             show_header_toggle: false
             entities:
               - entity: sensor.maria_db_size
                 name: Объем БД
                 icon: mdi:database

           - type: history-graph
             entities:
               - entity: sensor.maria_db_size
             name: Maria DB

       - type: vertical-stack
         cards:
          - entities:
              - entity: input_boolean.disable_alerts_notifications
              - entity: input_boolean.disable_voice_alerts
              - type: divider
              - entity: input_boolean.ac_status
              - entity: input_boolean.heating_status
              - entity: input_number.climate_target_temperature
              - type: divider
              - entity: input_boolean.disable_climate
              - entity: input_boolean.disable_home_away
              - entity: input_boolean.disable_occupancy
              - type: divider
              - entity: input_boolean.disable_climate_notifications
              - entity: input_boolean.disable_voice_notifications
              - entity: input_boolean.disable_startup_notifications
              - entity: input_boolean.disable_zone_notifications
            show_header_toggle: false
            title: Переключатели
            icon: mdi:sync-off
            type: entities
            state_color: true

   - title: Сенсоры
     icon: mdi:motion-sensor

     cards:

       - type: vertical-stack
         title: Гостинная
         cards:
            - type: entities
              state_color: true
              entities:

                - type: custom:multiple-entity-row
                  entity: binary_sensor.living_room_loggia_door_contact
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  name: Дверь на лоджию
                  entities:
                    - entity: sensor.living_room_loggia_door_battery
                      name: Батарея
                      
                - type: custom:multiple-entity-row
                  entity: binary_sensor.living_room_lumi_sensor_motion_occupancy
                  name: Датчик движения
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  entities:
                    - entity: sensor.living_room_lumi_sensor_motion_battery
                      name: Батарея
                    - entity: sensor.living_room_lumi_sensor_motion_illuminance_lux
                      name: Освещенность
                  
                - type: custom:multiple-entity-row
                  entity: sensor.living_room_lumi_weather_temperature
                  icon: mdi:home-thermometer
                  name: Климат
                  secondary_info: last-changed
                  state_header: Температура
                  entities:
                    - entity: sensor.living_room_lumi_weather_battery
                      name: Батарея
                    - entity: sensor.living_room_lumi_weather_pressure
                      name: Давление
                    - entity: sensor.living_room_lumi_weather_humidity
                      name: Влажность

                - type: custom:multiple-entity-row
                  entity: switch.living_room_aquarium_main_lighting
                  icon: mdi:fishbowl-outline
                  name: Аквариум
                  secondary_info: last-changed
                  state_color: true
                  show_state: false
                  entities:
                    - entity: sensor.living_room_aquarium_main_lighting_voltage
                      name: Напряжение
                      unit: 'V'
                    - entity: sensor.living_room_aquarium_main_lighting_power
                      name: Мощность
                      unit: 'W'
                    - entity: sensor.living_room_aquarium_main_lighting_meter
                      name: За месяц
                      unit: 'kW*h'

                - type: custom:multiple-entity-row
                  entity: binary_sensor.living_room_socket_heating_status
                  name: Обогреватель
                  secondary_info: last-changed
                  state_color: true
                  show_state: false
                  entities:
                    - entity: sensor.living_room_socket_heating_voltage
                      name: Напряжение
                      unit: 'V'
                    - entity: sensor.living_room_socket_heating_power
                      name: Мощность
                      unit: 'W'
                    - entity: sensor.living_room_socket_heating_meter
                      name: За месяц
                      unit: 'kW*h'

                - type: custom:multiple-entity-row
                  entity: binary_sensor.living_room_air_conditioner_socket_status
                  name: Кондиционер
                  secondary_info: last-changed
                  state_color: true
                  show_state: false
                  entities:
                    - entity: sensor.living_room_air_conditioner_socket_voltage
                      name: Напряжение
                      unit: 'V'
                    - entity: sensor.living_room_air_conditioner_socket_power
                      name: Мощность
                      unit: 'W'
                    - entity: sensor.living_room_air_conditioner_socket_meter
                      name: За месяц
                      unit: 'kW*h'

       - type: vertical-stack
         title: Спальня
         cards:
            - type: entities
              state_color: true
              entities:

                - type: custom:multiple-entity-row
                  entity: binary_sensor.bedroom_windows
                  name: Окно
                  state_header: Состояние
                  secondary_info: last-changed
                  state_color: true
                  show_state: true
                  entities:
                    - entity: sensor.bedroom_window_left_battery
                      name: Батарея-Л
                    - entity: sensor.bedroom_window_right_battery
                      name: Батарея-П
                    - entity: binary_sensor.bedroom_window_left_contact
                      name: Левое
                      icon: true
                      state_color: true
                    - entity: binary_sensor.bedroom_window_right_contact
                      name: Правое
                      icon: true
                      state_color: true

                - type: custom:multiple-entity-row
                  entity: binary_sensor.bedroom_lumi_sensor_motion_occupancy
                  name: Датчик движения
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  entities:
                    - entity: sensor.bedroom_lumi_sensor_motion_battery
                      name: Батарея
                    - entity: sensor.bedroom_lumi_sensor_motion_illuminance_lux
                      name: Освещенность

                - type: custom:multiple-entity-row
                  entity: sensor.bedroom_lumi_weather_temperature
                  icon: mdi:home-thermometer
                  name: Климат
                  secondary_info: last-changed
                  state_header: Температура
                  entities:
                    - entity: sensor.bedroom_lumi_weather_battery
                      name: Батарея
                    - entity: sensor.bedroom_lumi_weather_pressure
                      name: Давление
                    - entity: sensor.bedroom_lumi_weather_humidity
                      name: Влажность

                - type: custom:multiple-entity-row
                  entity: binary_sensor.bedroom_socket_heating_status
                  name: Обогреватель
                  secondary_info: last-changed
                  state_color: true
                  show_state: false
                  entities:
                    - entity: sensor.bedroom_socket_heating_voltage
                      name: Напряжение
                      unit: 'V'
                    - entity: sensor.bedroom_socket_heating_power
                      name: Мощность
                      unit: 'W'
                    - entity: sensor.bedroom_socket_heating_meter
                      name: За месяц
                      unit: 'kW*h'

                - type: custom:multiple-entity-row
                  entity: binary_sensor.bedroom_air_conditioner_socket_status
                  name: Кондиционер
                  secondary_info: last-changed
                  state_color: true
                  show_state: false
                  entities:
                    - entity: sensor.bedroom_air_conditioner_socket_voltage
                      name: Напряжение
                      unit: 'V'
                    - entity: sensor.bedroom_air_conditioner_socket_power
                      name: Мощность
                      unit: 'W'
                    - entity: sensor.bedroom_air_conditioner_socket_meter
                      name: За месяц
                      unit: 'kW*h'

       - type: vertical-stack
         title: Кухня
         cards:
            - type: entities
              state_color: true
              entities:
                - type: custom:multiple-entity-row
                  entity: binary_sensor.kitchen_window_contact
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  name: Окно
                  entities:
                    - entity: sensor.kitchen_window_battery
                      name: Батарея

                - type: custom:multiple-entity-row
                  entity: binary_sensor.kitchen_smoke_detector_smoke
                  name: Датчик дыма
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  entities:
                    - entity: sensor.kitchen_smoke_detector_battery
                      name: Батарея

                - type: custom:multiple-entity-row
                  entity: binary_sensor.kitchen_water_leak_sensor_water_leak
                  name: Датчик протечки
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  entities:
                    - entity: sensor.kitchen_water_leak_sensor_battery
                      name: Батарея

                - type: custom:multiple-entity-row
                  entity: sensor.kitchen_lumi_weather_temperature
                  icon: mdi:home-thermometer
                  name: Климат
                  secondary_info: last-changed
                  state_header: Температура
                  entities:
                    - entity: sensor.kitchen_lumi_weather_battery
                      name: Батарея
                    - entity: sensor.kitchen_lumi_weather_pressure
                      name: Давление
                    - entity: sensor.kitchen_lumi_weather_humidity
                      name: Влажность

                - type: custom:multiple-entity-row
                  entity: binary_sensor.kitchen_socket_heating_status
                  name: Обогреватель
                  secondary_info: last-changed
                  state_color: true
                  show_state: false
                  entities:
                    - entity: sensor.kitchen_socket_heating_voltage
                      name: Напряжение
                      unit: 'V'
                    - entity: sensor.kitchen_socket_heating_power
                      name: Мощность
                      unit: 'W'
                    - entity: sensor.kitchen_socket_heating_meter
                      name: За месяц
                      unit: 'kW*h'

       - type: vertical-stack
         title: Ванная
         cards:
            - type: entities
              state_color: true
              entities: 
                - type: custom:multiple-entity-row
                  entity: binary_sensor.bathroom_water_leak_under_the_bath_water_leak
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  name: Датчик протечки, под ванной
                  entities:
                    - entity: sensor.bathroom_water_leak_under_the_bath_battery
                      name: Батарея

                - type: custom:multiple-entity-row
                  entity: binary_sensor.bathroom_water_leak_under_washing_machine_water_leak
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  name: Датчик протечки, под стиральной машиной
                  entities:
                    - entity: sensor.bathroom_water_leak_under_washing_machine_battery
                      name: Батарея

                - type: custom:multiple-entity-row
                  entity: sensor.bathroom_lumi_weather_temperature
                  icon: mdi:home-thermometer
                  name: Климат
                  secondary_info: last-changed
                  state_header: Температура
                  entities:
                    - entity: sensor.bathroom_lumi_weather_battery
                      name: Батарея
                    - entity: sensor.bathroom_lumi_weather_pressure
                      name: Давление
                    - entity: sensor.bathroom_lumi_weather_humidity
                      name: Влажность

                - type: custom:multiple-entity-row
                  entity: binary_sensor.bathroom_washing_machine_socket_status
                  name: Стиральная машина
                  secondary_info: last-changed
                  state_color: true
                  show_state: false
                  entities:
                    - entity: sensor.bathroom_washing_machine_socket_voltage
                      name: Напряжение
                      unit: 'V'
                    - entity: sensor.bathroom_washing_machine_socket_power
                      name: Мощность
                      unit: 'W'
                    - entity: sensor.bathroom_washing_machine_socket_meter
                      name: За месяц
                      unit: 'kW*h'

       - type: vertical-stack
         title: Коридор
         cards:
            - type: entities
              state_color: true
              entities:
                - type: custom:multiple-entity-row
                  entity: binary_sensor.hallway_entrance_door_contact
                  secondary_info: last-changed
                  state_header: Состояние
                  state_color: true
                  name: Входная дверь
                  entities:
                    - entity: sensor.hallway_entrance_door_battery
                      name: Батарея
                - entity: light.hallway_rgb_bulb
                  name: Коридор, сигнальная лампа
                - entity: binary_sensor.tapo_camera_motion
                  name: Датчик Движения, Камера

       - type: vertical-stack
         title: Лоджия
         cards:
            - type: entities
              state_color: true
              entities:
                - type: custom:multiple-entity-row
                  entity: sensor.loggia_tuya_weather_temperature
                  icon: mdi:home-thermometer
                  name: Климат
                  secondary_info: last-changed
                  state_header: Температура
                  entities:
                    - entity: sensor.loggia_tuya_weather_battery
                      name: Батарея
                    - entity: sensor.loggia_tuya_weather_humidity
                      name: Влажность

    #   - type: vertical-stack
    #      title: Улица
    #      cards:
    #       - type: entities
    #          state_color: true
    #          entities:
    #           - entity: sensor.season
    #              name: 'Сезон'
    #           - entity: sensor.outdoor_humidity
    #           - entity: sensor.outdoor_temperature
    #           - entity: sensor.outdoor_mean_temperature

       - type: vertical-stack
         title: 'Температурные Графики'
         cards:
         
           - type: history-graph
             title: "Квартира"
             hours_to_show: 168
             entities:
               - entity: sensor.living_room_lumi_weather_temperature
                 name:  Гостинная
               - entity: sensor.bedroom_lumi_weather_temperature
                 name: Спальня
               - entity: sensor.kitchen_lumi_weather_temperature
                 name: Кухня
               - entity: sensor.bathroom_lumi_weather_temperature
                 name: Ванная
               - entity: sensor.loggia_tuya_weather_temperature
                 name: Лоджия

    #   - type: vertical-stack
    #      cards:
           - type: history-graph
             title: "Внешняя Температура"
             hours_to_show: 168
             entities:
               - sensor.outdoor_temperature
               - sensor.outdoor_mean_temperature

       - type: vertical-stack
         title: Статус Батареи
         cards:
           - type: custom:auto-entities
             card:
               type: entities
             filter:
               include:
                - entity_id: sensor.*battery
             sort:
               method: state
               numeric: true
